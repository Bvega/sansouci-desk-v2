# SANSOUCI V2 - DEVELOPMENT SECURITY CONFIGURATION
# Place this in your project root directory

# PHP Security Settings for Development
php_flag display_errors Off
php_flag log_errors On
php_value error_log "storage/logs/php_errors.log"

# Session Security
php_flag session.cookie_httponly On
php_flag session.use_strict_mode On
php_value session.cookie_samesite "Strict"

# File Security
php_flag allow_url_fopen Off
php_flag allow_url_include Off

# Hide PHP version
php_flag expose_php Off

# Security Headers
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Frame-Options "DENY"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# Block access to sensitive files
<FilesMatch "\.(env|log|ini|conf)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Block access to vendor and storage directories from web
RedirectMatch 404 /vendor/.*$
RedirectMatch 404 /storage/.*$
RedirectMatch 404 /tests/.*$